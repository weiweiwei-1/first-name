login:
 @RequestMapping(value="/login",method={RequestMethod.GET,RequestMethod.POST})
    @ResponseBody
    public Map login3(User user){
        String username=user.getUsername();
        String address=user.getAddress();
        String result;
        if(username.isEmpty()){
            result="0";//用户名不能为空
        }
        else{
            User user1=userService.selectByName(username);
            System.out.println(user1);
            if(user1==null){
                result="1";//用户不存在
            }
            else if(!address.equals(user1.getAddress())){
                result="2";//地址错误
            }
            else{
                result="3";//登录成功
                Subject subject=SecurityUtils.getSubject();
                try{
                    UsernamePasswordToken token=new UsernamePasswordToken(username,address);
//                    token.setRememberMe(true);
                    subject.login(token);
                }
                catch(AuthenticationException ex){
                    System.out.println("登陆异常，请查看是否其他人在别处登陆了账号");
                }
                Session session=subject.getSession();
                session.setAttribute("username",user.getUsername());
                System.out.println(session.getAttribute("username"));
            }
        }
        Map<String,String> map=new HashMap<>();
        map.put("result",result);
        return map;
    }


register:
 @RequestMapping(value="/register",method={RequestMethod.GET,RequestMethod.POST})
   @ResponseBody
    public Map<String,String> register(User user){
       Map<String,String> map=new HashMap<>();
       String UsernameError;
       String AddressError;
       String Symbol="1";
       if(StringUtils.isBlank(user.getUsername())){
           UsernameError="用户名不能为空";Symbol="0";
       }
       else if(userService.selectByName(user.getUsername())!=null){
           UsernameError="用户已经存在";Symbol="0";
       }
       else{
           UsernameError="";
       }

       if(StringUtils.isBlank(user.getAddress())){
           AddressError="地址不能为空";Symbol="0";
       }
       else if(user.getAddress().length()<4){
           AddressError="地址长度太短";Symbol="0";
       }
       else{
           AddressError="";
       }
       if(Symbol.equals("0")){
           map.put("usernameError",UsernameError);
           map.put("addressError",AddressError);
           map.put("Symbol","0");
       }
       else{
           userService.insert(user);
           map.put("Symbol","1");
           Subject subject=SecurityUtils.getSubject();
           try {
               subject.login(new UsernamePasswordToken(user.getUsername(),user.getAddress()));
           }catch(AuthenticationException ex){
               System.out.println("授权登录失败");
           }
           Session session=subject.getSession();
           System.out.println("session对象为:");
           System.out.println(session.getAttribute("username"));
       }
       return map;
    }